

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>7. 케라스 모델 고급 활용법 &#8212; Deep Learning with Python(2판)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=c5ced968eda925caa686" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=c5ced968eda925caa686" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=c5ced968eda925caa686" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=c5ced968eda925caa686" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=c5ced968eda925caa686"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'working_with_keras';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. 컴퓨터 비전 기초: 합성곱 신경망" href="computer_vision_intro.html" />
    <link rel="prev" title="6. 머신러닝 작업 흐름 일반" href="unversal_workflow_of_ml.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Deep Learning with Python(2판)</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="what_is_deep_learning.html">1. 딥러닝 소개</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="building_blocks_of_NN.html">2. 신경망 기본 구성 요소</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="tensor_intro.html">2.5. 부록: 텐서 소개</a></li>
<li class="toctree-l2"><a class="reference internal" href="tf_tensor.html">2.6. 부록: 텐서플로우 텐서</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="keras_and_tf.html">3. 케라스와 텐서플로우</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_with_neural_networks.html">4. 신경망 활용 처음부터 끝까지: 분류와 회귀</a></li>
<li class="toctree-l1"><a class="reference internal" href="fundamentals_of_ml.html">5. 머신러닝 모델 훈련 기법</a></li>
<li class="toctree-l1"><a class="reference internal" href="unversal_workflow_of_ml.html">6. 머신러닝 작업 흐름 일반</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">7. 케라스 모델 고급 활용법</a></li>
<li class="toctree-l1"><a class="reference internal" href="computer_vision_intro.html">8. 컴퓨터 비전 기초: 합성곱 신경망</a></li>
<li class="toctree-l1"><a class="reference internal" href="computer_vision_advanced.html">9. 고급 컴퓨터 비전</a></li>
<li class="toctree-l1"><a class="reference internal" href="dl_for_timeseries.html">10. 시계열 분석</a></li>
<li class="toctree-l1"><a class="reference internal" href="dl_for_text.html">11. 자연어 처리</a></li>
<li class="toctree-l1"><a class="reference internal" href="generative_dl.html">12. 생성 모델</a></li>
<li class="toctree-l1"><a class="reference internal" href="best_practices.html">13. 딥러닝 실전 적용</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/codingalzi/dlp2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/codingalzi/dlp2/issues/new?title=Issue%20on%20page%20%2Fworking_with_keras.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/working_with_keras.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>케라스 모델 고급 활용법</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential">7.1. 케라스 모델 구성법 1: <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 모델 활용</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api">7.2. 케라스 모델 구성법 2: 함수형 API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">7.2.1. 다중 입력, 다중 출력 모델</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">7.2.2. 모델 구조 그래프</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">7.2.3. 모델 재활용</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">7.3. 케라스 모델 구성법 3: 서브클래싱</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">7.4. 케라스 혼합 모델 구성법</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">7.5. 훈련 평가 방식 지정</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">7.5.1. 콜백</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">7.5.2. 텐서보드</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">7.6. 연습문제</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="ch-working-with-keras">
<span id="id1"></span><h1><span class="section-number">7. </span>케라스 모델 고급 활용법<a class="headerlink" href="#ch-working-with-keras" title="Permalink to this heading">#</a></h1>
<p><strong>감사의 글</strong></p>
<p>아래 내용은 프랑소와 숄레의
<a class="reference external" href="https://github.com/fchollet/deep-learning-with-python-notebooks">Deep Learning with Python(2판)</a>의
소스코드 내용을 참고해서 작성되었습니다.
자료를 공개한 저자에게 진심어린 감사를 전합니다.</p>
<p><strong>소스코드</strong></p>
<p>여기서 언급되는 코드를
<a class="reference external" href="https://colab.research.google.com/github/codingalzi/dlp2/blob/master/notebooks/NB-working_with_keras.ipynb">(구글 코랩) 케라스 모델 활용법</a>에서
직접 실행할 수 있다.</p>
<p><strong>슬라이드</strong></p>
<p>본문 내용을 요약한 <a class="reference external" href="https://github.com/codingalzi/dlp2/raw/master/slides/slides-working_with_keras.pdf">슬라이드</a>를 다운로드할 수 있다.</p>
<p><strong>주요 내용</strong></p>
<ul class="simple">
<li><p>다양한 모델 구성법</p></li>
<li><p>모델과 층의 재활용</p></li>
<li><p>모델 훈련 옵션: 콜백과 텍서보드</p></li>
</ul>
<section id="sequential">
<h2><span class="section-number">7.1. </span>케라스 모델 구성법 1: <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 모델 활용<a class="headerlink" href="#sequential" title="Permalink to this heading">#</a></h2>
<p>케라스를 이용하여 매우 간단한 방식부터 매우 복잡한 방식까지 다양한 방식으로
필요한 수준의 모델을 구성할 수 있다.
또한 케라스의 모델과 층은 모두 각각 <code class="docutils literal notranslate"><span class="pre">Model</span></code> 클래스와 <code class="docutils literal notranslate"><span class="pre">Layer</span></code> 클래스를 상속하기에
다른 모델 또는 층과의 융합도 용이하다.</p>
<p>케라스를 이용하여 세 가지 방식으로 딥러닝 모델을 구성할 수 있다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 모델 활용: 층으로 스택을 쌓아 만든 모델</p></li>
<li><p>함수형 API 활용: 가장 많이 사용됨.</p></li>
<li><p>모델 서브클래싱: 모든 것을 사용자가 지정.</p></li>
</ul>
<p>먼저 <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 모델은 층으로 스택을 쌓아 만든 모델이며 가장 단순하다.</p>
<ul class="simple">
<li><p>한 종류의 입력값과 한 종류의 출력값만 사용 가능</p>
<ul>
<li><p>순전파: 지정된 층의 순서대로 적용</p></li>
</ul>
</li>
</ul>
<p><strong><code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 클래스</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow</span> <span class="kn">import</span> <span class="n">keras</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">layers</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">([</span>
    <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">),</span>
    <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
<p>층을 스택에 추가하기 위해 <code class="docutils literal notranslate"><span class="pre">add</span></code> 메서드를 이용할 수도 있다.
더해진 순서대로 층이 쌓인다.
예를 들어, 아래 코드는 앞서 정의한 모델과 동일한 모델을 구성한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>모델의 가중치와 <code class="docutils literal notranslate"><span class="pre">build()</span></code> 메서드</strong></p>
<p>지금 당장 모델에 포함된 각각의 층에서 데이터 변환(순전파)를 위해 사용되는 가중치와 편향을 확인하려 하면 오류가 발생한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">weights</span>
<span class="gp">...</span>
<span class="go">ValueError: Weights for model sequential_1 have not yet been created. </span>
<span class="go">Weights are created when the Model is first called on inputs or </span>
<span class="go">`build()` is called with an `input_shape`.</span>
</pre></div>
</div>
<p>이유는 가중치 행렬의 크기와 편향 벡터의 길이가 정해지지 않았기 때문이다.
지금까지는 훈련을 시작하면서 가장 먼저 층별로 가중치 행렬은 임의로, 편향 텐서는 0으로
초기화된다고만 설명했다.
이것이 가능했던 이유는
훈련이 시작되어 입력 데이터셋이 전달될 때 입력 샘플에 포함된 특성의 개수가 첫째 층에 알려지고,
그 정보와 함께 층별 유닛수를 이용하여 가중치 행렬과 편향 벡터의 모양을 정할 수 있기 때문이다.</p>
<p>층별 가중치 행렬과 편향 벡터의 초기화는 앞서 설명한 대로
각 층의 <code class="docutils literal notranslate"><span class="pre">build()</span></code> 메서드가 담당한다.
아래 코드는 <a class="reference internal" href="keras_and_tf.html#ch-keras-tf"><span class="std std-numref">3장</span></a>에서 선언한
<code class="docutils literal notranslate"><span class="pre">SimpleDense</span></code>에서의 <code class="docutils literal notranslate"><span class="pre">build()</span></code> 메서드를 보여준다.
이미 설명하대로 첫째 층에 입력값이 처음 들어올 때 알려지는 입력값의 특성 수와
층에 포함된 유닛 수를 이용하여 가중치 행렬과 편향 벡터를 초기화 한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_shape</span><span class="p">):</span>
    <span class="n">input_dim</span> <span class="o">=</span> <span class="n">input_shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># 입력 샘플의 특성 수</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">),</span>
                             <span class="n">initializer</span><span class="o">=</span><span class="s2">&quot;random_normal&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_weight</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,),</span>
                             <span class="n">initializer</span><span class="o">=</span><span class="s2">&quot;zeros&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>모델 역시 <code class="docutils literal notranslate"><span class="pre">build()</span></code> 메서드를 가지며, 해당 메서드를 적절한 인자와 함께 호출하면
모델에 포함된 모든 층에 포함된 <code class="docutils literal notranslate"><span class="pre">build()</span></code> 메서드가 적절한 인자와 함게 호출되어
층별로 가중치 행렬과 편향 벡터를 초기화된다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">input_shape</span></code> 키워드 인자: 배치 입력 데이터셋 텐서의 모양인 <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">특성수)</span></code> 와 같은 인자 사용</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>은 배치의 크기는 중요하지 않음을 의미함, 즉 임의의 크기의 배치 데이터셋 처리 가능.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p>위 모델에 대해서 층별로 가중치 행렬과 편향 벡터 하나씩 총 4 개의 텐서가 생성된다.
생성된 모든 텐서를 항목으로 갖는 리스트를 모델의 <code class="docutils literal notranslate"><span class="pre">weights</span></code> 속성이 가리킨다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<ul class="simple">
<li><p>1층의 가중치 행렬과 편향 벡터</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># 가중치 행렬</span>
<span class="go">TensorShape([3, 64])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># 편향 벡터</span>
<span class="go">TensorShape([64])</span>
</pre></div>
</div>
<ul class="simple">
<li><p>2층의 가중치 행렬과 편향 벡터</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># 가중치 행렬</span>
<span class="go">TensorShape([64, 10])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># 편향 벡터</span>
<span class="go">TensorShape([10])</span>
</pre></div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">summary()</span></code> 메서드</strong></p>
<p>완성된 모델의 층의 구조와 각 층의 출력값의 모양 정보를 확인할 수 있다.</p>
<ul class="simple">
<li><p>모델과 층의 이름: 특별히 지정하지 않으면 기본 이름 자동으로 할당됨.</p></li>
<li><p>층별 출력값의 모양(<code class="docutils literal notranslate"><span class="pre">Output</span> <span class="pre">Shape</span></code>): 유닛수 확인. <code class="docutils literal notranslate"><span class="pre">None</span></code> 은 임의의 배치크기를 가리킴.</p></li>
<li><p>층별 파라미터 수(<code class="docutils literal notranslate"><span class="pre">Param</span> <span class="pre">#</span></code>): 훈련을 통해 학습되어야 하는 파라미터들의 개수</p>
<ul>
<li><p>가중치 행렬과 편향 벡터에 포함된 항목들의 수를 가리킴.</p></li>
</ul>
</li>
<li><p>파라미터 수</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Total</span> <span class="pre">params</span></code>: 파라미터의 총 개수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Trainable</span> <span class="pre">params</span></code>: 가중치 행렬과 편향 벡터에 포함된 파라리터처럼 훈련을 통해 학습(업데이트)되는 파라미터 총 개수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Non-trainable</span> <span class="pre">params</span></code>: 훈련에는 관여하지만 훈련을 통해 학습되지는 않는 파라미터.
지금까지 다룬 모델에서는 비학습 파라미터 사용되지 않았음.
나중에 비학습 파라미터 예제를 다룰 것임 (<a class="reference internal" href="computer_vision_advanced.html#ch-computer-vision-advanced"><span class="std std-numref">9장</span></a> 참고).</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">Model: &quot;sequential_1&quot;</span>
<span class="go">_________________________________________________________________</span>
<span class="go">Layer (type)                 Output Shape              Param #   </span>
<span class="go">=================================================================</span>
<span class="go">dense_2 (Dense)              (None, 64)                256       </span>
<span class="go">_________________________________________________________________</span>
<span class="go">dense_3 (Dense)              (None, 10)                650       </span>
<span class="go">=================================================================</span>
<span class="go">Total params: 906</span>
<span class="go">Trainable params: 906</span>
<span class="go">Non-trainable params: 0</span>
<span class="go">_________________________________________________________________</span>
</pre></div>
</div>
<p><strong><code class="docutils literal notranslate"><span class="pre">Input()</span></code> 함수</strong></p>
<p>모델 훈련을 시작하거나 모델의 <code class="docutils literal notranslate"><span class="pre">build()</span></code> 메서드를 실행하기 전까지는 모델의 <code class="docutils literal notranslate"><span class="pre">summary()</span></code> 메서드가 작동하지 않는다.
그리고 그 이유는 입력값의 모양, 즉 특성 수를 미리 알지 못하기 때문이었다.</p>
<p>그런데 모델을 구성할 때 <code class="docutils literal notranslate"><span class="pre">Input()</span></code> 함수를 활용하면 모델 훈련에 사용될
입력값에 대한 정보를 모델에 미리 전달할 수 있다.
예를 들어 아래 코드는 훈련셋의 샘플이 3 개의 특성을 갖는다는 것을 가리킨다.
물론, 이렇게 입력값의 정보를 미리 지정하면 지정된 모양의 훈련셋만 사용할 수 있다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Sequential</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,)))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p>이제 <code class="docutils literal notranslate"><span class="pre">build()</span></code> 메서드를 실행할 필요 없이 바로 <code class="docutils literal notranslate"><span class="pre">summary()</span></code>를 실행하여
모델의 구조를 확인할 수 있다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">Model: &quot;sequential_2&quot;</span>
<span class="go">_________________________________________________________________</span>
<span class="go">Layer (type)                 Output Shape              Param #   </span>
<span class="go">=================================================================</span>
<span class="go">dense_4 (Dense)              (None, 64)                256       </span>
<span class="go">=================================================================</span>
<span class="go">Total params: 256</span>
<span class="go">Trainable params: 256</span>
<span class="go">Non-trainable params: 0</span>
<span class="go">_________________________________________________________________</span>
</pre></div>
</div>
<p>층을 추가할 때 마다 모델의 구조를 확인할 수 있다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">Model: &quot;sequential_2&quot;</span>
<span class="go">_________________________________________________________________</span>
<span class="go">Layer (type)                 Output Shape              Param #   </span>
<span class="go">=================================================================</span>
<span class="go">dense_4 (Dense)              (None, 64)                256       </span>
<span class="go">_________________________________________________________________</span>
<span class="go">dense_5 (Dense)              (None, 10)                650       </span>
<span class="go">=================================================================</span>
<span class="go">Total params: 906</span>
<span class="go">Trainable params: 906</span>
<span class="go">Non-trainable params: 0</span>
<span class="go">_________________________________________________________________</span>
</pre></div>
</div>
</section>
<section id="api">
<h2><span class="section-number">7.2. </span>케라스 모델 구성법 2: 함수형 API<a class="headerlink" href="#api" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 클래스를 사용하면 한 종류의 입력값과 한 종류의 출력값만을 사용할 수 있다.
반면에 함수형 API를 이용하면 다중 입력과 다중 출력을 지원하는
모델을 구성할 수 있다.
즉, 모델이 서로 다른 종류의 입력값과 서로 다른 종류의 출력값을 지원한다.</p>
<p><strong>기본 활용법</strong></p>
<p>앞서 살펴 본 <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 모델을 함수형 API를 이용하여 구성하면 다음과 같다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_input&quot;</span><span class="p">)</span>          <span class="c1"># 입력층</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>     <span class="c1"># 은닉층</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">features</span><span class="p">)</span> <span class="c1"># 출력층</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>        <span class="c1"># 모델 지정</span>
</pre></div>
</div>
<p>사용된 단계들을 하나씩 살펴보자.</p>
<ul>
<li><p>입력층: 여기서는 한 개만 사용</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;my_input&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p>은닉층: 입력층의 값을 이어 받음. 여러 개의 은닉층을 자유 자재로 구성 가능.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p>출력층: 최종 은닉층의 결과를 이어 받아 출력값 계산. 여기서는 한 개만 사용.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p>모델 빌드: 입력층과 출력층을 이용하여 모델 지정</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">summary()</span></code> 의 실행결과는 이전과 동일하다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">Model: &quot;functional_1&quot; </span>
<span class="go">_________________________________________________________________</span>
<span class="go">Layer (type)                 Output Shape              Param # </span>
<span class="go">=================================================================</span>
<span class="go">my_input (InputLayer)        [(None, 3)]               0 </span>
<span class="go">_________________________________________________________________</span>
<span class="go">dense_6 (Dense)              (None, 64)                256 </span>
<span class="go">_________________________________________________________________</span>
<span class="go">dense_7 (Dense)              (None, 10)                650 </span>
<span class="go">=================================================================</span>
<span class="go">Total params: 906 </span>
<span class="go">Trainable params: 906 </span>
<span class="go">Non-trainable params: 0 </span>
<span class="go">_________________________________________________________________</span>
</pre></div>
</div>
<section id="id2">
<h3><span class="section-number">7.2.1. </span>다중 입력, 다중 출력 모델<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>다중 입력과 다중 출력을 지원하는 모델을 구성하는 방법을 예제를 이용하여 설명한다.</p>
<div class="proof example admonition" id="exp-customer">
<p class="admonition-title"><span class="caption-number">Example 7.1 </span> (고객 요구사항 접수 모델)</p>
<section class="example-content" id="proof-content">
<p>고객의 요구사항이 입력되었을 때 처리 우선순위와 담당부서를 지정하는 시스템을 구현하려 한다.
고객의 요구사항은 세 종류의 입력값으로 구성된다.
따라서 시스템에 사용될 딥러닝 모델은 세 개의 입력값과 두 개의 출력값을 사용한다.</p>
<p>입력 사항 세 종류는 다음과 같다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">title</span></code>: 요구사항 제목</p>
<ul>
<li><p>제목을  멀티-핫 인코딩한 0과 1로 구성된 길이가 1만인 벡터.</p></li>
<li><p>1만등 이내의 사용빈도를 갖는 단어만 사용됨.</p></li>
<li><p><a class="reference internal" href="getting_started_with_neural_networks.html#ch-getting-started-with-neural-networks"><span class="std std-numref">4장</span></a>의IMDB 영화 후기 멀티-핫 인코딩 참고</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">text_body</span></code>: 요구사항 내용</p>
<ul>
<li><p>요구사항 내용을  멀티-핫 인코딩한 0과 1로 구성된 길이가 1만인 벡터.</p></li>
<li><p>1만등 이내의 사용빈도를 갖는 단어만 사용됨.</p></li>
<li><p><a class="reference internal" href="getting_started_with_neural_networks.html#ch-getting-started-with-neural-networks"><span class="std std-numref">4장</span></a>의IMDB 영화 후기 멀티-핫 인코딩 참고</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">tags</span></code>: 사용자에 의한 추가 선택 사항</p>
<ul>
<li><p>100개 중 여러 개 선택.</p></li>
<li><p>멀티-핫 인코딩된 길이가 1만인 벡터.</p></li>
</ul>
</li>
</ul>
<p>출력 사항 두 종류는 다음과 같다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">priority</span></code>: 요구사항 처리 우선순위.</p>
<ul>
<li><p>0에서 1사이의 값.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sigmoid</span></code> 활성화 함수 활용.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">department</span></code>: 네 개의 요구사항 처리 담당 부서 중 하나 선택.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">softmax</span></code> 활성화 함수 활용.</p></li>
</ul>
</li>
</ul>
</section>
</div><p>고객 요구사항 접수 모델을 함수형 API를 이용하여 다음과 같이
구현할 수 있다.</p>
<ul class="simple">
<li><p>입력층: 세 개</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">title</span></code>: 제목 입력 처리</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">text_body</span></code>:  요구사항 내용 입력 처리</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tags</span></code>: 추가 선택사항 처리</p></li>
</ul>
</li>
<li><p>은닉층: 두 개</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Concatenate</span></code> 층: 여러 개의 텐서를 좌우로 이어붙임.
여기서는 고객의 요구사항 제목, 내용, 추가 선택사항을 담고 있는
길이가 각각 1만, 1만, 100인 세 개의 벡터를 이어붙여서
길이가 총 2만1백인 하나의 벡터로 변환.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dense</span></code> 층: 64 개의 유닛과 함께 <code class="docutils literal notranslate"><span class="pre">relu()</span></code> 함수 사용</p></li>
</ul>
</li>
<li><p>출력층: 두 개</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">priority</span></code>: 요구사항 처리 우선순위 판단. 0과 1사의 값을 계산하는 <code class="docutils literal notranslate"><span class="pre">Dense</span></code> 층.
1개의 유닛과 <code class="docutils literal notranslate"><span class="pre">sigmoid()</span></code> 활성화함수 지정.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">department</span></code>: 요구사항 처리 담당 부서 선택. 4 개의 부서 각각에 대한 처리 활률값을 계산하는 <code class="docutils literal notranslate"><span class="pre">Dense</span></code> 층.
4개의 유닛과 <code class="docutils literal notranslate"><span class="pre">softmax()</span></code> 활성화함수 지정.</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vocabulary_size</span> <span class="o">=</span> <span class="mi">10000</span>    <span class="c1"># 사용빈도 1만등 인내 단어 사용</span>
<span class="n">num_tags</span> <span class="o">=</span> <span class="mi">100</span>             <span class="c1"># 태그 수</span>
<span class="n">num_departments</span> <span class="o">=</span> <span class="mi">4</span>        <span class="c1"># 부서 수</span>

<span class="c1"># 입력층: 세 개</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">vocabulary_size</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;title&quot;</span><span class="p">)</span>
<span class="n">text_body</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">vocabulary_size</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;text_body&quot;</span><span class="p">)</span>
<span class="n">tags</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_tags</span><span class="p">,),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;tags&quot;</span><span class="p">)</span>

<span class="c1"># 은닉층</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Concatenate</span><span class="p">()([</span><span class="n">title</span><span class="p">,</span> <span class="n">text_body</span><span class="p">,</span> <span class="n">tags</span><span class="p">])</span> <span class="c1"># shape=(None, 10000+10000+100)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># 출력층: 두 개</span>
<span class="n">priority</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;priority&quot;</span><span class="p">)(</span><span class="n">features</span><span class="p">)</span>
<span class="n">department</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>
    <span class="n">num_departments</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;department&quot;</span><span class="p">)(</span><span class="n">features</span><span class="p">)</span>

<span class="c1"># 모델 빌드: 입력값으로 구성된 입력값 리스트와 출력값으로 구성된 출력값 리스트 사용</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">title</span><span class="p">,</span> <span class="n">text_body</span><span class="p">,</span> <span class="n">tags</span><span class="p">],</span> <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">priority</span><span class="p">,</span> <span class="n">department</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>모델 컴파일</strong></p>
<p>손실함수와 평가지표 모두 출력층의 개수만큼 지정한다.</p>
<ul class="simple">
<li><p>손실함수(loss)</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">priority</span></code> 대상: <code class="docutils literal notranslate"><span class="pre">mean_squared_error</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">department</span></code> 대상: <code class="docutils literal notranslate"><span class="pre">categorical_crossentropy</span></code></p></li>
</ul>
</li>
<li><p>평가지표(metrics): 평가지표는 대상 별로 여러 개를 사용할 수 있기에 각각의 대상에 대해 평가지표 리스트를 작성함.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">priority</span></code> 대상: <code class="docutils literal notranslate"><span class="pre">[&quot;mean_absolute_error&quot;,</span> <span class="pre">&quot;mean_squared_error&quot;]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">department</span></code> 대상: <code class="docutils literal notranslate"><span class="pre">[&quot;accuracy&quot;,</span> <span class="pre">&quot;AUC&quot;,</span> <span class="pre">&quot;Precision&quot;]</span></code></p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;mean_squared_error&quot;</span><span class="p">,</span> <span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">],</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;mean_absolute_error&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_squared_error&quot;</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="s2">&quot;AUC&quot;</span><span class="p">,</span> <span class="s2">&quot;Precision&quot;</span><span class="p">]])</span>
</pre></div>
</div>
<p><strong>모델 훈련</strong></p>
<p>모델 훈련은 <code class="docutils literal notranslate"><span class="pre">fit()</span></code> 함수에 세 개의 훈련 텐서로 이루어진 리스트와
두 개의 타깃 텐서로 이루어진 리스트를 지정한 후에 실행한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">([</span><span class="n">title_data</span><span class="p">,</span> <span class="n">text_body_data</span><span class="p">,</span> <span class="n">tags_data</span><span class="p">],</span>
          <span class="p">[</span><span class="n">priority_data</span><span class="p">,</span> <span class="n">department_data</span><span class="p">]</span>
          <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>모델 평가</strong></p>
<p>모델 평가도 훈련과 동일한 방식으로 구성된 인자가 사용된다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">([</span><span class="n">title_data</span><span class="p">,</span> <span class="n">text_body_data</span><span class="p">,</span> <span class="n">tags_data</span><span class="p">],</span>
               <span class="p">[</span><span class="n">priority_data</span><span class="p">,</span> <span class="n">department_data</span><span class="p">])</span>
</pre></div>
</div>
<p><strong>모델 활용</strong></p>
<p>예측값은 두 개의 출력층 각각에서 생성된 두 개의 어레이로 구성된 리스트이다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">priority_preds</span><span class="p">,</span> <span class="n">department_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">([</span><span class="n">title_data</span><span class="p">,</span> <span class="n">text_body_data</span><span class="p">,</span> <span class="n">tags_data</span><span class="p">])</span>
</pre></div>
</div>
<ul>
<li><p>우선 순위 예측값: 0과 1사이의 확률값</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">priority_preds</span>
<span class="go">array([[1.],</span>
<span class="go">       [1.],</span>
<span class="go">       [1.],</span>
<span class="go">       ...,</span>
<span class="go">       [1.],</span>
<span class="go">       [1.],</span>
<span class="go">       [1.]], dtype=float32)</span>
</pre></div>
</div>
</li>
</ul>
<ul>
<li><p>처리 부서 예측값: 각 부서별 적정도를 가리키는 확률값</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">department_preds</span>
<span class="go">array([[3.15035926e-04, 9.99676108e-01, 3.48305429e-38, 8.79832805e-06],</span>
<span class="go">       [2.57118052e-04, 9.99649763e-01, 2.81043147e-36, 9.31219838e-05],</span>
<span class="go">       [1.25319435e-04, 9.99730408e-01, 5.14789972e-38, 1.44241771e-04],</span>
<span class="go">       ...,</span>
<span class="go">       [2.07843386e-05, 9.99939203e-01, 6.17548646e-37, 4.00628560e-05],</span>
<span class="go">       [5.92015058e-05, 9.99811471e-01, 3.15372667e-37, 1.29307984e-04],</span>
<span class="go">       [1.07195789e-04, 9.99771416e-01, 1.70482034e-36, 1.21468736e-04]],</span>
<span class="go">      dtype=float32)</span>
</pre></div>
</div>
</li>
</ul>
<p><strong>사전 객체 활용</strong></p>
<p>입력층과 출력층의 이름을 이용하여 사전 형식으로 입력값과 출력값을 지정할 수 있다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;adam&quot;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="s2">&quot;mean_squared_error&quot;</span><span class="p">,</span> <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="s2">&quot;categorical_crossentropy&quot;</span><span class="p">},</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;mean_absolute_error&quot;</span><span class="p">,</span> <span class="s2">&quot;mean_squared_error&quot;</span><span class="p">],</span> <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="s2">&quot;AUC&quot;</span><span class="p">,</span> <span class="s2">&quot;Precision&quot;</span><span class="p">]})</span>

<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title_data</span><span class="p">,</span> <span class="s2">&quot;text_body&quot;</span><span class="p">:</span> <span class="n">text_body_data</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">tags_data</span><span class="p">},</span>
          <span class="p">{</span><span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="n">priority_data</span><span class="p">,</span> <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="n">department_data</span><span class="p">},</span>
          <span class="n">epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">({</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title_data</span><span class="p">,</span> <span class="s2">&quot;text_body&quot;</span><span class="p">:</span> <span class="n">text_body_data</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">tags_data</span><span class="p">},</span>
               <span class="p">{</span><span class="s2">&quot;priority&quot;</span><span class="p">:</span> <span class="n">priority_data</span><span class="p">,</span> <span class="s2">&quot;department&quot;</span><span class="p">:</span> <span class="n">department_data</span><span class="p">})</span>

<span class="n">priority_preds</span><span class="p">,</span> <span class="n">department_preds</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span>
    <span class="p">{</span><span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">title_data</span><span class="p">,</span> <span class="s2">&quot;text_body&quot;</span><span class="p">:</span> <span class="n">text_body_data</span><span class="p">,</span> <span class="s2">&quot;tags&quot;</span><span class="p">:</span> <span class="n">tags_data</span><span class="p">})</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3><span class="section-number">7.2.2. </span>모델 구조 그래프<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">plot_model()</span></code>을 이용하여 층 연결 구조를 그래프로 나타낼 수 있다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;ticket_classifier.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div align="center"><img src="https://github.com/codingalzi/dlp2/blob/master/jupyter-book/imgs/ch07-ticket_classifier.png?raw=true" style="width:400px;"></div><div class="info admonition">
<p class="admonition-title">층 연결 그래프 그리기</p>
<p><code class="docutils literal notranslate"><span class="pre">keras.utils.plot_model()</span></code> 함수가 제대로 작동하려면
<code class="docutils literal notranslate"><span class="pre">pydot</span></code> 파이썬 모듈과 graphviz 라는 프로그램이 컴퓨터에 설치되어 있어야 한다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pydot</span></code> 모듈 설치: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pydot</span></code></p></li>
<li><p>graphviz 프로그램 설치: <a class="reference external" href="https://graphviz.gitlab.io/download/">https://graphviz.gitlab.io/download/</a></p></li>
<li><p>구글 코랩에서는 기본으로 지원됨.</p></li>
</ul>
</div>
<p>입력 텐서와 출력 텐서의 모양을 함께 표기할 수도 있다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;ticket_classifier_with_shape_info.png&quot;</span><span class="p">,</span> <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div align="center"><img src="https://github.com/codingalzi/dlp2/blob/master/jupyter-book/imgs/ch07-ticket_classifier_with_shapes.png?raw=true" style="width:900px;"></div></section>
<section id="id4">
<h3><span class="section-number">7.2.3. </span>모델 재활용<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<p>훈련된 모델을 새로운 모델을 구성하는 데에 활용할 수 있다.
먼저 모델의 <code class="docutils literal notranslate"><span class="pre">layers</span></code> 속성을 이용하여 사용된 층에 대한 정보를 확인한다.
<code class="docutils literal notranslate"><span class="pre">layers</span></code> 속성은 사용된 층들로 이루어진 리스트를 가리킨다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">layers</span>
<span class="go">[&lt;keras.src.engine.input_layer.InputLayer at 0x7fc3a1313fd0&gt;,</span>
<span class="go"> &lt;keras.src.engine.input_layer.InputLayer at 0x7fc3a13ce450&gt;,</span>
<span class="go"> &lt;keras.src.engine.input_layer.InputLayer at 0x7fc3a13c5990&gt;,</span>
<span class="go"> &lt;keras.src.layers.merging.concatenate.Concatenate at 0x7fc3a13e0d50&gt;,</span>
<span class="go"> &lt;keras.src.layers.core.dense.Dense at 0x7fc3a13a6310&gt;,</span>
<span class="go"> &lt;keras.src.layers.core.dense.Dense at 0x7fc3a12f6850&gt;,</span>
<span class="go"> &lt;keras.src.layers.core.dense.Dense at 0x7fc3a13e2f90&gt;]</span>
</pre></div>
</div>
<p>예를 들어, 3번 인덱스에 해당하는 층의 입력값과 출력값에 대한 정보는 아래처럼 확인할 수 있다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">input</span>
<span class="go">[&lt;KerasTensor: shape=(None, 10000) dtype=float32 (created by layer &#39;title&#39;)&gt;,</span>
<span class="go"> &lt;KerasTensor: shape=(None, 10000) dtype=float32 (created by layer &#39;text_body&#39;)&gt;,</span>
<span class="go"> &lt;KerasTensor: shape=(None, 100) dtype=float32 (created by layer &#39;tags&#39;)&gt;]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">output</span>
<span class="go">&lt;KerasTensor: shape=(None, 20100) dtype=float32 (created by layer &#39;concatenate&#39;)&gt;</span>
</pre></div>
</div>
<p>여기서는 문제해결의 어려움 정도를 “quick”, “medium”, “difficult”로 구분하는 어려움 정도를 판별하는
출력층을 추가하여 총 세 종류의 출력값을 생성하는 모델을 얻고자 한다.
원래는 모델을 새로 구성하고 훈련을 처음부터 다시 시작해야 한다.
하지만 어차피 훈련과정이 이전과 특별히 다를 이유가 없다.
이런 경우 이전에 훈련된 모델의 일부를 재활용할 수 있다.
기존에 훈련된 모델을 재활용하는 경우
일반적으로 출력층을 제외한 나머지 층을 재활용 대상으로 삼는다.</p>
<p>기존 모델에서 출력층은 5번과 6번 인덱스에 위치하기에
4번 인덱스가 가리키는 (은닉)층의 출력 정보를 따로 떼어낸다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">features</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">output</span>
</pre></div>
</div>
<p>그런 다음 이제 출력층에 문제해결의 어려움 정도를 판별하는 층을 아래와 같이 지정한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">difficulty</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;difficulty&quot;</span><span class="p">)(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
<p>새로이 준비된 <code class="docutils literal notranslate"><span class="pre">'difficulty'</span></code> 층을 기존에 사용된 두 개의 출력층과 함께
새로운 모델의 출력층으로 지정한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span><span class="n">title</span><span class="p">,</span> <span class="n">text_body</span><span class="p">,</span> <span class="n">tags</span><span class="p">],</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span><span class="n">priority</span><span class="p">,</span> <span class="n">department</span><span class="p">,</span> <span class="n">difficulty</span><span class="p">])</span>
</pre></div>
</div>
<p>모델 구성 그래프는 다음과 같다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keras</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plot_model</span><span class="p">(</span><span class="n">new_model</span><span class="p">,</span> <span class="s2">&quot;updated_ticket_classifier.png&quot;</span><span class="p">,</span> <span class="n">show_shapes</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div align="center"><img src="https://github.com/codingalzi/dlp2/blob/master/jupyter-book/imgs/ch07-ticket_classifier_with_shapes-02.png?raw=true" style="width:900px;"></div><p>요약 결과는 다음과 같다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">new_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="go">Model: &quot;model_2&quot;</span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">Layer (type)                    Output Shape         Param #     Connected to                     </span>
<span class="go">==================================================================================================</span>
<span class="go">title (InputLayer)              [(None, 10000)]      0                                            </span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">text_body (InputLayer)          [(None, 10000)]      0                                            </span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">tags (InputLayer)               [(None, 100)]        0                                            </span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">concatenate (Concatenate)       (None, 20100)        0           title[0][0]                      </span>
<span class="go">                                                                 text_body[0][0]                  </span>
<span class="go">                                                                 tags[0][0]                       </span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">dense_8 (Dense)                 (None, 64)           1286464     concatenate[0][0]                </span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">priority (Dense)                (None, 1)            65          dense_8[0][0]                    </span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">department (Dense)              (None, 4)            260         dense_8[0][0]                    </span>
<span class="go">__________________________________________________________________________________________________</span>
<span class="go">difficulty (Dense)              (None, 3)            195         dense_8[0][0]                    </span>
<span class="go">==================================================================================================</span>
<span class="go">Total params: 1,286,984</span>
<span class="go">Trainable params: 1,286,984</span>
<span class="go">Non-trainable params: 0</span>
<span class="go">__________________________________________________________________________________________________</span>
</pre></div>
</div>
<p>새로 생성된 모델은 출력층을 제외한 나머지 층들이 기존 모델의 훈련 과정에서 학습한
가중치 행렬과 편향 벡터를 그대로 유지한다.</p>
<p>모델 재활용은 기존에 매우 잘 훈련된 모델을 새로운 문제를 해결하는 딥러닝 모델을
훈련시킬 때 많이 사용하는 기법이다.
<a class="reference internal" href="computer_vision_advanced.html#ch-computer-vision-advanced"><span class="std std-numref">9장</span></a>에서 모델 재활용을 자세히 다룬다.</p>
</section>
</section>
<section id="id5">
<h2><span class="section-number">7.3. </span>케라스 모델 구성법 3: 서브클래싱<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">keras.Model</span></code> 클래스를 상속하는 모델 클래스를 직접 선언하여 활용하는 기법이
<strong>서브클래싱</strong><font size='2'>subclassing</font>이다.</p>
<p>서브클래싱으로 모델 클래서를 선언하려면 아래 두 메서드를 목적에 맞추어
재정의<font size='2'>overriding</font>한다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__init__()</span></code> 메서드(생성자): 은닉층과 출력층으로 사용될 층 객체 지정</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">call()</span></code> 메서드: 층을 연결하는 과정 지정. 즉, 입력값으부터 출력값을 만들어내는 순전파 과정 묘사.</p></li>
</ul>
<p>앞서 함수형 API로 구성한 고객 요구사항 접수 모델(두 종류의 출력값 생성 모델)을 서브클래싱을 기법을 이용하여 구현하면 다음과 같다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CustomerTicketModel</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_departments</span><span class="p">):</span> <span class="c1"># num_departments: 고객 요구사항 처리 부서 개수</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat_layer</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Concatenate</span><span class="p">()</span>                      <span class="c1"># 은닉층</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mixing_layer</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)</span>       <span class="c1"># 은닉층</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">priority_scorer</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">)</span>  <span class="c1"># 출력층 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">department_classifier</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span>                    <span class="c1"># 출력층 2</span>
            <span class="n">num_departments</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;softmax&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>               <span class="c1"># inputs: 사전 객체 입력값. 모양은 미정.</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
        <span class="n">text_body</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;text_body&quot;</span><span class="p">]</span>
        <span class="n">tags</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">[</span><span class="s2">&quot;tags&quot;</span><span class="p">]</span>

        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat_layer</span><span class="p">([</span><span class="n">title</span><span class="p">,</span> <span class="n">text_body</span><span class="p">,</span> <span class="n">tags</span><span class="p">])</span>    <span class="c1"># 은닉층 연결</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mixing_layer</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="n">priority</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">priority_scorer</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>                 <span class="c1"># 출력층 연결</span>
        <span class="n">department</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">department_classifier</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">priority</span><span class="p">,</span> <span class="n">department</span>                               <span class="c1"># 두 종류의 출력값 지정</span>
</pre></div>
</div>
<p>이전과 동일한 구성의 모델은 다음과 같이 선언한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">CustomerTicketModel</span><span class="p">(</span><span class="n">num_departments</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>입력값의 정보가 없기에 층별 가중치와 편향은 초기화되지 않는다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">weights</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>컴파일, 훈련, 평가, 예측은 이전과 완전히 동일한 방식으로 실행된다.</p>
<p><strong>서브클래싱 기법의 장단점</strong></p>
<ul class="simple">
<li><p>장점</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">call()</span></code> 함수를 이용하여 층을 임의로 구성할 수 있다.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span></code> 반복문 등 파이썬 프로그래밍 모든 기법을 적용할 수 있다.</p></li>
</ul>
</li>
<li><p>단점</p>
<ul>
<li><p>모델 구성을 전적으로 책임져야 한다.</p></li>
<li><p>모델 구성 정보가 <code class="docutils literal notranslate"><span class="pre">call()</span></code> 함수 외부로 노출되지 않아서
앞서 보았던 그래프 표현을 사용할 수 없다.</p></li>
</ul>
</li>
</ul>
<p><strong>모델은 층의 자식 클래스</strong></p>
<p>모델 서브클래싱은 <code class="docutils literal notranslate"><span class="pre">keras.layers.Layer</span></code>를 상속하여 사용자 정의 층 클래스를 선언하는 방식과
거의 동일하다 (<a class="reference internal" href="keras_and_tf.html#ch-keras-tf"><span class="std std-numref">3장</span></a> 참고).
이유는 <code class="docutils literal notranslate"><span class="pre">keras.Model</span></code>이 <code class="docutils literal notranslate"><span class="pre">keras.layers.Layer</span></code>의 자식 클래스이기 때문이다.
그리고 모델 클래스는 <code class="docutils literal notranslate"><span class="pre">fit()</span></code>, <code class="docutils literal notranslate"><span class="pre">evaluate()</span></code>, <code class="docutils literal notranslate"><span class="pre">predict()</span></code> 메서드를 함께 지원하기에
모델의 훈련, 평가, 예측을 총괄할 수 있다.
물론 모든 과정에서 훈련된 층에 저장된 가중치 행렬과 편향 벡터를 이용한다.</p>
</section>
<section id="id6">
<h2><span class="section-number">7.4. </span>케라스 혼합 모델 구성법<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h2>
<p>소개된 세 가지 방식을 임의로 혼합하여 활용할 수 있다.
무엇보다도 모델 클래스가 층의 하위 클래스이기에
선언된/훈련된 모델을 다른 모델의 하나의 층으로 활용할 수도 있다.</p>
<p><strong>예제: 서브클래싱 모델을 함수형 모델에 활용하기</strong> (강추!!!)</p>
<p>먼저 서브클래싱으로 하나의 모델을 선언한다.</p>
<ul class="simple">
<li><p>한 개의 밀집층만 사용</p></li>
<li><p>이진 분류인 경우: 하나의 유닛과 <code class="docutils literal notranslate"><span class="pre">sigmoid</span></code> 활성화 함수 사용</p></li>
<li><p>다중 클래스 분류인 경우: 클래스(범주) 수 만큼의 유닛과  <code class="docutils literal notranslate"><span class="pre">softmax</span></code> 활성화 함수 사용</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Classifier</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">num_classes</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">num_units</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;sigmoid&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_units</span> <span class="o">=</span> <span class="n">num_classes</span>
            <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;softmax&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_units</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">activation</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</pre></div>
</div>
<p>아래 코드는 함수형 API 형식으로 새로운 모델을 지정한다.
이때 위 모델 클래스의 객체를 출력층으로 사용한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,))</span>                       <span class="c1"># 입력층</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span> <span class="c1"># 은닉층</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">Classifier</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">10</span><span class="p">)(</span><span class="n">features</span><span class="p">)</span>         <span class="c1"># 출력층</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>예제: 함수형 모델을 서브클래싱 모델에 활용하기</strong></p>
<p>먼저 함수형 API 형식으로 하나의 모델을 선언한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">inputs</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">64</span><span class="p">,))</span>
<span class="n">outputs</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;sigmoid&quot;</span><span class="p">)(</span><span class="n">inputs</span><span class="p">)</span>
<span class="n">binary_classifier</span> <span class="o">=</span> <span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="n">inputs</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="n">outputs</span><span class="p">)</span>
</pre></div>
</div>
<p>아래 <code class="docutils literal notranslate"><span class="pre">MyModel</span></code> 클래스는 앞서 선언한 <code class="docutils literal notranslate"><span class="pre">binary_classifier</span></code> 모델을 출력층으로 활용한다.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">layers</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">&quot;relu&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span> <span class="o">=</span> <span class="n">binary_classifier</span>

    <span class="k">def</span> <span class="nf">call</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dense</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">classifier</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id7">
<h2><span class="section-number">7.5. </span>훈련 평가 방식 지정<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h2>
<p>딥러닝 모델의 훈련은 한 번 시작되면 훈련이 종료될 때까지 어떤 간섭도 받지 않는다.
즉, 훈련 시작 이전의 컴파일 과정에서 지정된 설정을 훈련 중간에 변경할 수 없다.
다만, 훈련 진행과정을 관찰<font size='2'>monitoring</font>할 수 있을 뿐이다.</p>
<p>훈련 과정 동안 관찰할 수 있는 내용은 일반적으로 다음과 같다.</p>
<ul class="simple">
<li><p>에포크별 손실값</p></li>
<li><p>에포크별 평가지표</p></li>
</ul>
<p>손실값과 평가지표를 계산하는 방식은 모델을 컴파일할 때 지정된다.
케라스가 지원하는 방식 중에 하나를 선택하거나
필요에 따라 사용자가 직접 선언한 손실함수 또는 평가지표 클래스를 활용할 수 있다.
평가지표의 경우 <code class="docutils literal notranslate"><span class="pre">keras.metrics.Metric</span></code> 클래스를 상속해야 케라스의 다른 평가지표 클래스와 호환된다.</p>
<p>여기서는 훈련 과정을 조정하고 계산되는 손실값과 평가지표를 활용하는 방식을 지정하는 콜백 기능과
텐서보드를 소개한다.</p>
<section id="id8">
<h3><span class="section-number">7.5.1. </span>콜백<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<p>컴퓨터 프로그래밍에서 <strong>콜백</strong><font size='2'>callback</font>은
하나의 프로그램이 실행되는 도중에 추가적으로 다른 API를 호출하는 기능 또는 해당 API를 가리킨다.
호출된 콜백은 자신을 호출한 프로그램과 독립적으로 실행된다.</p>
<p>머신러닝 모델 훈련 과정에서 사용될 수 있는 다양한 콜백 기능을 케라스가 제공한다.
일반적으로 손실값, 평가지표 등 훈련 중에 계산되는 기록을 저장하여 활용하며,
가장 많이 활용되는 콜백은 다음과 같다.</p>
<ul class="simple">
<li><p>훈련 기록 작성</p>
<ul>
<li><p>훈련셋, 검증셋에 대한 손실값, 평가지표 기록 및 출력</p></li>
<li><p>훈련 에포크마다 보여지는 손실값, 평가지표 등 관리</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keras.callbacks.CSVLogger</span></code> 클래스 활용.</p></li>
<li><p>기본으로 지원되도록 설정되었음.</p></li>
</ul>
</li>
<li><p>훈련중인 모델의 상태 저장</p>
<ul>
<li><p>모델의 <strong>상태</strong>: 훈련 중인 모델에 저장된 가중치와 편향 등의 파라미터 정보</p></li>
<li><p>훈련 중 가장 좋은 성능의 모델(의 상태) 저장</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keras.callbacks.ModelCheckpoint</span></code> 클래스 활용</p></li>
</ul>
</li>
<li><p>훈련 조기 종료</p>
<ul>
<li><p>검증셋에 대한 손실이 더 이상 개선되지 않는 경우 훈련을 종료 시키기</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keras.callbacks.EarlyStopping</span></code> 클래스 활용</p></li>
</ul>
</li>
<li><p>하이퍼 파라미터 조정</p>
<ul>
<li><p>학습률 동적 변경 지원</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keras.callbacks.LearningRateScheduler</span></code> 또는 <code class="docutils literal notranslate"><span class="pre">keras.callbacks.ReduceLROnPlateau</span></code> 클래스 활용</p></li>
</ul>
</li>
</ul>
<p><strong>예제</strong></p>
<p>콜백은 <code class="docutils literal notranslate"><span class="pre">fit()</span></code> 함수의 <code class="docutils literal notranslate"><span class="pre">callbacks</span></code>라는 옵션 인자를 이용하여 지정한다.
예를 들어 아래 코드는 두 종류의 콜백을 지정한다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EarlyStopping</span></code>: 검증셋에 대한 정확도가 2 에포크 연속 개선되지 않을 때 훈련 종료</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ModelCheckpoint</span></code>: 매 에포크마다 훈련된 모델 상태 저장</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">save_best_only=True</span></code>: 검증셋에 대한 손실값이 가장 낮은 모델만 저장</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">callbacks_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">EarlyStopping</span><span class="p">(</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_accuracy&quot;</span><span class="p">,</span>
        <span class="n">patience</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">keras</span><span class="o">.</span><span class="n">callbacks</span><span class="o">.</span><span class="n">ModelCheckpoint</span><span class="p">(</span>
        <span class="n">filepath</span><span class="o">=</span><span class="s2">&quot;checkpoint_path&quot;</span><span class="p">,</span>
        <span class="n">monitor</span><span class="o">=</span><span class="s2">&quot;val_loss&quot;</span><span class="p">,</span>
        <span class="n">save_best_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">]</span>

<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s2">&quot;rmsprop&quot;</span><span class="p">,</span>
              <span class="n">loss</span><span class="o">=</span><span class="s2">&quot;sparse_categorical_crossentropy&quot;</span><span class="p">,</span>
              <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_images</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">,</span>
          <span class="n">epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
          <span class="n">callbacks</span><span class="o">=</span><span class="n">callbacks_list</span><span class="p">,</span>
          <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">val_images</span><span class="p">,</span> <span class="n">val_labels</span><span class="p">))</span>
</pre></div>
</div>
<p><strong>사용자 정의 콜백</strong></p>
<p>케라스와 호환되는 콜백 클래스를 정의하려면 <code class="docutils literal notranslate"><span class="pre">keras.callbacks.Callback</span></code> 클래스를 상속하면 된다.</p>
</section>
<section id="id9">
<h3><span class="section-number">7.5.2. </span>텐서보드<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p><strong>텐서보드</strong><font size='2'>TensorBoard</font>는 모델 훈련 과정을 시각적으로 실시간 관찰할 수 있는 도구를 제공하며
텐서플로우와 함께 설치된다.</p>
<ul class="simple">
<li><p>모델 구조 시각화</p></li>
<li><p>손실값, 정확도 등의 변화 시각화</p></li>
<li><p>가중치, 편향 텐서 등의 변화 히스토그램</p></li>
<li><p>이미지, 텍스트, 오디오 데이터 시각화</p></li>
<li><p>기타 다양한 기능 제공</p></li>
</ul>
<div align="center"><img src="https://github.com/codingalzi/dlp2/blob/master/jupyter-book/imgs/ch07-tensorboard.png?raw=true" style="width:600px;"></div></section>
</section>
<section id="id10">
<h2><span class="section-number">7.6. </span>연습문제<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://colab.research.google.com/github/codingalzi/dlp2/blob/master/excs/exc-working_with_keras.ipynb">(실습) 케라스 모델 고급 활용법</a></p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="unversal_workflow_of_ml.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">6. </span>머신러닝 작업 흐름 일반</p>
      </div>
    </a>
    <a class="right-next"
       href="computer_vision_intro.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8. </span>컴퓨터 비전 기초: 합성곱 신경망</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential">7.1. 케라스 모델 구성법 1: <code class="docutils literal notranslate"><span class="pre">Sequential</span></code> 모델 활용</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#api">7.2. 케라스 모델 구성법 2: 함수형 API</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">7.2.1. 다중 입력, 다중 출력 모델</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">7.2.2. 모델 구조 그래프</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">7.2.3. 모델 재활용</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">7.3. 케라스 모델 구성법 3: 서브클래싱</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">7.4. 케라스 혼합 모델 구성법</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">7.5. 훈련 평가 방식 지정</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">7.5.1. 콜백</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">7.5.2. 텐서보드</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">7.6. 연습문제</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By 코딩알지
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=c5ced968eda925caa686"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=c5ced968eda925caa686"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>